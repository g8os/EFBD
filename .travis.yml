sudo: required
dist: trusty
language: go

branches:
  except:
    - adds-etcdconfig

jobs:
  include:
    - stage: test
      go: 1.8
      install: skip
      script: TIMEOUT=5m make testgo
    - stage: test
      go: 1.8
      install: skip
      script: TIMEOUT=5m make testrace
    - stage: test
      go: 1.8
      install:
        - ./tlog/install_dependencies.sh
      script: TIMEOUT=5m make testcgo
    - stage: test
      go: 1.8
      os: osx
      install:
        - go get -u github.com/Jumpscale/go-raml
        - ./tlog/install_capnp_macos.sh
      script: make testcodegen
